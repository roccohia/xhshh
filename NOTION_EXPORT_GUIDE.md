# 📅 Notion 内容日历导出指南

基于小红书数据分析结果，自动生成适用于 Notion 导入的内容日历 CSV 文件。

## 🎯 功能概览

`export_notionsheet.py` 脚本可以：
- 📊 读取已有的数据分析结果
- 📅 生成30天内容日历
- 🎯 智能分配主题和目标人群
- 📝 提供标题草稿和内容建议
- 📋 输出 Notion 可直接导入的 CSV 格式

## 🚀 快速使用

### 基础用法

```bash
# 生成30天内容日历
python analysis/export_notionsheet.py

# 生成15天内容日历
python analysis/export_notionsheet.py --days 15

# 自定义输出文件名
python analysis/export_notionsheet.py --filename my_calendar.csv
```

### 高级用法

```bash
# 指定分析结果目录
python analysis/export_notionsheet.py --input-dir analysis_results --output-dir exports

# 生成60天长期日历
python analysis/export_notionsheet.py --days 60 --filename long_term_calendar.csv
```

## 📋 输出字段说明

生成的 CSV 文件包含以下字段，完全适配 Notion 数据库导入：

| 字段名 | 说明 | 示例 |
|--------|------|------|
| **Date** | 发布日期 | 2025-07-02 |
| **主题方向** | 内容类型分类 | 数字型内容、体验分享类 |
| **标题草稿** | 基于高互动标题生成 | "我的30天普拉提挑战" |
| **关键词标签** | 前5个高频关键词 | "普拉提、运动、减肥" |
| **目标人群** | 随机分配1-2个人群 | "宝妈、健身初学者" |
| **内容亮点** | 自动提取的内容特色 | "数字、效果、体验" |
| **内容建议** | 针对主题的创作建议 | "分享个人真实体验，包含前后对比" |
| **笔记链接** | 原始笔记链接（如有） | https://www.xiaohongshu.com/... |
| **发布状态** | 默认状态 | "待写" |

## 📊 数据来源

脚本会自动查找以下分析文件：

### 必需文件
- `topic_suggestions_*.csv` - 选题建议（来自 topic_generator.py）
- `high_engagement_*.csv` - 高互动内容（来自 competitor_analysis.py）
- `keywords_analysis_*.csv` - 关键词分析（来自 keyword_analysis.py）

### 文件查找逻辑
- 自动查找最新的时间戳文件
- 支持指定输入目录
- 缺失文件时使用默认值

## 🎨 智能特性

### 1. 主题分布优化
- 确保各类主题均匀分布
- 周末安排轻松内容（打卡分享类）
- 避免连续相同主题

### 2. 标题智能变化
```
原标题: "30天普拉提挑战"
变化版本:
- "我的30天普拉提挑战"
- "30天普拉提挑战｜真实体验"
- "分享：30天普拉提挑战"
- "30天普拉提挑战（详细版）"
```

### 3. 内容亮点提取
自动识别标题中的亮点元素：
- **数字亮点**: "30天"、"5个动作"
- **效果亮点**: "减肥"、"塑形"、"改善"
- **体验亮点**: "亲测"、"真实"、"感受"
- **专业亮点**: "教程"、"技巧"、"方法"

### 4. 目标人群智能分配
根据内容类型智能匹配目标人群：
- 体验分享 → 宝妈、新手妈妈
- 教程指导 → 健身初学者、学生党
- 对比测评 → 上班族、职场女性

## 📁 输出文件

### 主要输出
- `notion_content_calendar.csv` - Notion 导入文件
- `notion_calendar_report_*.txt` - 生成报告

### 报告内容
- 📊 主题方向分布统计
- 👥 目标人群分布统计
- 🔤 关键词使用情况
- 📅 日期范围和条目数量

## 🔧 Notion 导入步骤

### 1. 创建 Notion 数据库
在 Notion 中创建新的数据库，包含以下属性：

```
Date - 日期类型
主题方向 - 选择类型 (数字型内容, 体验分享类, 教程指导类, 对比测评类, 知识科普类, 打卡分享)
标题草稿 - 文本类型
关键词标签 - 多选类型
目标人群 - 多选类型 (宝妈, 健身初学者, 上班族, 学生党, 职场女性, 新手妈妈)
内容亮点 - 文本类型
内容建议 - 文本类型
笔记链接 - URL类型
发布状态 - 选择类型 (待写, 写作中, 待发布, 已发布)
```

### 2. 导入 CSV 文件
1. 在 Notion 数据库右上角点击 "..." 
2. 选择 "Import"
3. 上传生成的 `notion_content_calendar.csv`
4. 确认字段映射
5. 完成导入

### 3. 后续优化
- 根据实际情况调整标题
- 补充内容亮点描述
- 设置提醒和截止日期
- 添加封面图片和标签

## 📈 实际应用示例

### 示例输出预览
```csv
Date,主题方向,标题草稿,关键词标签,目标人群,内容亮点,内容建议,笔记链接,发布状态
2025-07-02,数字型内容,我的30天普拉提挑战,普拉提、运动、减肥,宝妈、健身初学者,数字、效果,结合个人经验提供实用价值,,待写
2025-07-03,体验分享类,亲测这家普拉提馆｜真实体验,普拉提、体验、推荐,上班族,体验、专业,分享个人真实体验包含前后对比,,待写
```

### 使用场景
1. **内容策划**: 提前规划一个月的发布内容
2. **团队协作**: 分配给不同创作者
3. **进度跟踪**: 通过发布状态监控进度
4. **数据分析**: 基于实际数据制定策略

## 💡 最佳实践

### 1. 定期更新
- 每周运行一次数据分析
- 根据最新数据更新内容日历
- 调整主题方向和关键词

### 2. 个性化调整
- 根据品牌调性修改标题
- 调整目标人群定义
- 补充品牌特色内容

### 3. 数据驱动
- 跟踪发布后的数据表现
- 优化高表现内容类型
- 调整发布时间和频率

## 🔄 工作流程建议

```
1. 爬取数据 → 2. 运行分析 → 3. 生成日历 → 4. 导入Notion → 5. 内容创作 → 6. 发布跟踪
```

### 完整命令序列
```bash
# 1. 爬取最新数据
python scripts/run_crawler_enhanced.py --keyword "普拉提" --limit 100

# 2. 运行数据分析
python analysis/run_analysis_simple.py --input core/media_crawler/data/xhs/latest.csv

# 3. 生成Notion日历
python analysis/export_notionsheet.py --days 30

# 4. 导入到Notion并开始创作
```

## 🎉 总结

这个 Notion 导出工具将数据分析结果转化为可执行的内容计划，帮助你：

- 📊 **数据驱动**: 基于真实的高互动数据
- 🎯 **精准定位**: 智能匹配目标人群
- 📅 **系统规划**: 30天完整内容日历
- 🚀 **即用即导**: 直接导入Notion开始工作

让内容创作从灵感驱动转向数据驱动！
